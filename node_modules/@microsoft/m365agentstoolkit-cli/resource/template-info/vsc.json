[
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "no",
        "optionLabel": "No Action"
      }
    ],
    "templateName": "copilot-gpt-basic",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create declarative agent only",
    "readme": "# Overview of the Declarative Agent template\n\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\n\n## Get started with the template\n\n> **Prerequisites**\n>\n> To run this app template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\n\n![image](https://github.com/user-attachments/assets/51a221bb-a2c6-4dbf-8009-d2aa20a1638f)\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\n3. Select `Preview Local in Copilot (Edge)` or `Preview Local in Copilot (Chrome)` from the launch configuration dropdown.\n4. Select your declarative agent from the `Copilot` app.\n5. Ask a question to your declarative agent and it should respond based on the instructions provided.\n\n## What's included in the template\n\n| Folder       | Contents                                                                                 |\n| ------------ | ---------------------------------------------------------------------------------------- |\n| `.vscode`    | VSCode files for debugging                                                               |\n| `appPackage` | Templates for the application manifest, the GPT manifest and the API specification |\n| `env`        | Environment files                                                                        |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File                               | Contents                                                                     |\n| ---------------------------------- | ---------------------------------------------------------------------------- |\n| `appPackage/declarativeAgent.json` | Define the behaviour and configurations of the declarative agent.            |\n| `appPackage/manifest.json`         | application manifest that defines metadata for your declarative agent. |\n\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\n\n| File           | Contents                                                                                                                                  |\n| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml` | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\n\n## Extend the template\n\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\n- [Add Microsoft Copilot connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\n- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.\n\n## Addition information and references\n\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\n",
    "supportedLanguages": [
      "common"
    ],
    "templateIds": [
      "declarative-agent-basic"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "new-api",
        "optionLabel": "Start with a New API"
      },
      {
        "nodeId": "api-auth",
        "optionId": "none",
        "optionLabel": "None"
      }
    ],
    "templateName": "api-plugin-from-scratch",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create an action with a new API from Azure Functions",
    "readme": "# Overview of the Declarative Agent with API Plugin template\n\n## Build a Declarative Agent with API Plugin from a new API with Azure Functions\n\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\n\nYou can extend declarative agents using plugins to retrieve data and execute tasks on external systems. A declarative agent can utilize multiple plugins at the same time.\n![image](https://github.com/user-attachments/assets/9939972e-0449-410c-b237-d9d748cd6628)\n\n## Get started with the template\n\n> **Prerequisites**\n>\n> To run this app template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teams-toolkit-cli)\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\n3. Select `Debug in Copilot (Edge)` or `Debug in Copilot (Chrome)` from the launch configuration dropdown.\n4. Select your declarative agent from the `Copilot` app.\n5. Send a message to Copilot to find a repair record.\n\n## What's included in the template\n\n| Folder       | Contents                                                                                    |\n| ------------ | ------------------------------------------------------------------------------------------- |\n| `.vscode`    | VSCode files for debugging                                                                  |\n| `appPackage` | Templates for the application manifest, the plugin manifest and the API specification |\n| `env`        | Environment files                                                                           |\n| `infra`      | Templates for provisioning Azure resources                                                  |\n| `src`        | The source code for the repair API                                                          |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File                                            | Contents                                                                                          |\n| ----------------------------------------------- | ------------------------------------------------------------------------------------------------- |\n| `src/functions/repairs.js`                      | The main file of a function in Azure Functions.                                                   |\n| `src/repairsData.json`                          | The data source for the repair API.                                                               |\n| `appPackage/apiSpecificationFile/repair.yml`    | A file that describes the structure and behavior of the repair API.                               |\n| `appPackage/manifest.json`                      | application manifest that defines metadata for your plugin inside Microsoft Teams.          |\n| `appPackage/ai-plugin.json`                     | The manifest file for your API Plugin that contains information for your API and used by LLM.     |\n| `appPackage/repairDeclarativeAgent.json`        | Define the behaviour and configurations of the declarative agent.                                 |\n| `appPackage/adaptiveCards/listRepairs.json`     | Adaptive Card file used to render a result from the plugin response.                              |\n| `appPackage/adaptiveCards/listRepairs.data.json`| Sample mock data file for adaptive card.                                                          |\n\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\n\n| File                 | Contents                                                                                                                                  |\n| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\n| `m365agents.local.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging.                                                     |\n\n## Extend the template\n\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\n- [Add Microsoft Copilot connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\n- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.\n\n\n## Addition information and references\n\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\n- [Extend Microsoft 365 Copilot](https://aka.ms/teamsfx-copilot-plugin)\n- [Message extensions for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-message-extension-bot)\n- [Microsoft Copilot connectors for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-graph-connector)\n- [Microsoft 365 Copilot extensibility samples](https://learn.microsoft.com/microsoft-365-copilot/extensibility/samples)\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-scratch-ts",
      "declarative-agent-with-action-from-scratch-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "new-api",
        "optionLabel": "Start with a New API"
      },
      {
        "nodeId": "api-auth",
        "optionId": "api-key",
        "optionLabel": "API Key"
      }
    ],
    "templateName": "api-plugin-from-scratch-bearer",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create an action with a new API from Azure Functions",
    "readme": "# Overview of the Declarative Agent with API Plugin template\n\n## Build a Declarative Agent with API Plugin from a new API with Azure Functions\n\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\n\nYou can extend declarative agents using plugins to retrieve data and execute tasks on external systems. A declarative agent can utilize multiple plugins at the same time.\n![image](https://github.com/user-attachments/assets/9939972e-0449-410c-b237-d9d748cd6628)\n\n## Get started with the template\n\n> **Prerequisites**\n>\n> To run this app template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teams-toolkit-cli)\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\n3. Select `Debug in Copilot (Edge)` or `Debug in Copilot (Chrome)` from the launch configuration dropdown.\n4. Select your declarative agent from the `Copilot` app.\n5. Send a message to Copilot to find a repair record.\n\n### How to add your own API Key\n\n1. Open terminal and run command `npm install` to install all dependency packages\n\n   ```\n   > npm install\n   ```\n\n2. After `npm install` completed, run command `npm run keygen`\n   ```\n   > npm run keygen\n   ```\n3. The above command will output something like \"Generated a new API Key: xxx...\"\n4. Fill in API Key into `env/.env.*.user`\n   ```\n   SECRET_API_KEY=<your-api-key>\n   ```\n\n## What's included in the template\n\n| Folder       | Contents                                                                                    |\n| ------------ | ------------------------------------------------------------------------------------------- |\n| `.vscode`    | VSCode files for debugging                                                                  |\n| `appPackage` | Templates for the application manifest, the plugin manifest and the API specification |\n| `env`        | Environment files                                                                           |\n| `infra`      | Templates for provisioning Azure resources                                                  |\n| `src`        | The source code for the repair API                                                          |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File                                            | Contents                                                                                          |\n| ----------------------------------------------- | ------------------------------------------------------------------------------------------------- |\n| `src/functions/repairs.js`                      | The main file of a function in Azure Functions.                                                   |\n| `src/repairsData.json`                          | The data source for the repair API.                                                               |\n| `appPackage/apiSpecificationFile/repair.yml`    | A file that describes the structure and behavior of the repair API.                               |\n| `appPackage/manifest.json`                      | application manifest that defines metadata for your plugin inside Microsoft Teams.          |\n| `appPackage/ai-plugin.json`                     | The manifest file for your API Plugin that contains information for your API and used by LLM.     |\n| `appPackage/adaptiveCards/listRepairs.json`     | Adaptive Card file used to render a result from the plugin response.                              |\n| `appPackage/adaptiveCards/listRepairs.data.json`| Sample mock data file for adaptive card.                                                          |\n\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\n\n| File                 | Contents                                                                                                                                  |\n| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\n| `m365agents.local.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging.                                                     |\n\n## Extend the template\n\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\n- [Add Microsoft Copilot connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\n- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.\n\n## Addition information and references\n\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\n- [Extend Microsoft 365 Copilot](https://aka.ms/teamsfx-copilot-plugin)\n- [Message extensions for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-message-extension-bot)\n- [Microsoft CopilotcConnectors for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-graph-connector)\n- [Microsoft 365 Copilot extensibility samples](https://learn.microsoft.com/microsoft-365-copilot/extensibility/samples)\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-scratch-bearer-ts",
      "declarative-agent-with-action-from-scratch-bearer-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "new-api",
        "optionLabel": "Start with a New API"
      },
      {
        "nodeId": "api-auth",
        "optionId": "microsoft-entra",
        "optionLabel": "Microsoft Entra"
      }
    ],
    "templateName": "api-plugin-from-scratch-oauth",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create an action with a new API from Azure Functions",
    "readme": "# Overview of the Declarative Agent with API Plugin template\r\n\r\n## Build a Declarative Agent with API Plugin from a new API with Azure Functions\r\n\r\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\r\n\r\nYou can extend declarative agents using plugins to retrieve data and execute tasks on external systems. A declarative agent can utilize multiple plugins at the same time.\r\n![image](https://github.com/user-attachments/assets/9939972e-0449-410c-b237-d9d748cd6628)\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run this app template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teams-toolkit-cli)\r\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\r\n3. Select `Debug in Copilot (Edge)` or `Debug in Copilot (Chrome)` from the launch configuration dropdown.\r\n4. Select your declarative agent from the `Copilot` app.\r\n5. Send a message to Copilot to find a repair record.\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                                                                    |\r\n| ------------ | ------------------------------------------------------------------------------------------- |\r\n| `.vscode`    | VSCode files for debugging                                                                  |\r\n| `appPackage` | Templates for the application manifest, the plugin manifest and the API specification |\r\n| `env`        | Environment files                                                                           |\r\n| `infra`      | Templates for provisioning Azure resources                                                  |\r\n| `src`        | The source code for the repair API                                                          |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                            | Contents                                                                                                                     |\r\n| ----------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |\r\n| `src/functions/repairs.ts`                      | The main file of a function in Azure Functions.                                                                              |\r\n| `src/functions/middleware/tokenCacheWrapper.ts` | A wrapper class that handles caching of JWT signing keys to improve performance of token validation.                         |\r\n| `src/functions/middleware/tokenValidator.ts`    | Core class for validating JWT tokens from Microsoft Entra, including checks for claims, scopes, roles and tenant validation. |\r\n| `src/functions/middleware/authMiddleware.ts`    | Middleware function that handles authorization using JWT tokens, integrating with the token validator.                       |\r\n| `src/functions/middleware/utils.ts`             | Utility functions for authentication, including retrieving JWKS URIs for different cloud environments.                       |\r\n| `src/functions/middleware/config.ts`            | Configuration file that exports Microsoft Entra app settings from environment variables.                                     |\r\n| `src/repairsData.json`                          | The data source for the repair API.                                                                                          |\r\n| `appPackage/apiSpecificationFile/repair.yml`    | A file that describes the structure and behavior of the repair API.                                                          |\r\n| `appPackage/manifest.json`                      | application manifest that defines metadata for your plugin inside Microsoft Teams.                                     |\r\n| `appPackage/ai-plugin.json`                     | The manifest file for your API plugin that contains information for your API and used by LLM.                                |\r\n| `appPackage/repairDeclarativeAgent.json`        | Define the behaviour and configurations of the declarative agent.                                                            |\r\n| `appPackage/adaptiveCards/listRepairs.json`     | Adaptive Card file used to render a result from the plugin response.                                                         |\r\n| `appPackage/adaptiveCards/listRepairs.data.json`| Sample mock data file for adaptive Card.                                                                                     |\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                 | Contents                                                                                                                                                                                                                                                |\r\n| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions.                                                                                                               |\r\n| `m365agents.local.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging.                                                                                                                                                                   |\r\n| `aad.manifest.json`  | This file defines the configuration of Microsoft Entra app. This template will only provision [single tenant](https://learn.microsoft.com/azure/active-directory/develop/single-and-multi-tenant-apps#who-can-sign-in-to-your-app) Microsoft Entra app. |\r\n{{^MicrosoftEntra}}\r\n\r\n## Extend the template\r\n\r\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\r\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\r\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\r\n- [Add Microsoft Copilot connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\r\n- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.\r\n\r\n## How OAuth works in the API plugin\r\n\r\n![oauth-flow](https://github.com/OfficeDev/teams-toolkit/assets/107838226/f074abbe-d9e3-4a46-8e08-feb66b17a539)\r\n{{/MicrosoftEntra}}\r\n\r\n## Addition information and references\r\n\r\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\r\n- [Extend Microsoft 365 Copilot](https://aka.ms/teamsfx-copilot-plugin)\r\n- [Message extensions for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-message-extension-bot)\r\n- [Microsoft Copilot connectors for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-graph-connector)\r\n- [Microsoft 365 Copilot extensibility samples](https://learn.microsoft.com/microsoft-365-copilot/extensibility/samples)\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-scratch-oauth-ts",
      "declarative-agent-with-action-from-scratch-oauth-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "new-api",
        "optionLabel": "Start with a New API"
      },
      {
        "nodeId": "api-auth",
        "optionId": "oauth",
        "optionLabel": "OAuth"
      }
    ],
    "templateName": "api-plugin-from-scratch-oauth",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create an action with a new API from Azure Functions",
    "readme": "# Overview of the Declarative Agent with API Plugin template\r\n\r\n## Build a Declarative Agent with API Plugin from a new API with Azure Functions\r\n\r\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\r\n\r\nYou can extend declarative agents using plugins to retrieve data and execute tasks on external systems. A declarative agent can utilize multiple plugins at the same time.\r\n![image](https://github.com/user-attachments/assets/9939972e-0449-410c-b237-d9d748cd6628)\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run this app template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teams-toolkit-cli)\r\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\r\n3. Select `Debug in Copilot (Edge)` or `Debug in Copilot (Chrome)` from the launch configuration dropdown.\r\n4. Select your declarative agent from the `Copilot` app.\r\n5. Send a message to Copilot to find a repair record.\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                                                                    |\r\n| ------------ | ------------------------------------------------------------------------------------------- |\r\n| `.vscode`    | VSCode files for debugging                                                                  |\r\n| `appPackage` | Templates for the application manifest, the plugin manifest and the API specification |\r\n| `env`        | Environment files                                                                           |\r\n| `infra`      | Templates for provisioning Azure resources                                                  |\r\n| `src`        | The source code for the repair API                                                          |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                            | Contents                                                                                                                     |\r\n| ----------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |\r\n| `src/functions/repairs.ts`                      | The main file of a function in Azure Functions.                                                                              |\r\n| `src/functions/middleware/tokenCacheWrapper.ts` | A wrapper class that handles caching of JWT signing keys to improve performance of token validation.                         |\r\n| `src/functions/middleware/tokenValidator.ts`    | Core class for validating JWT tokens from Microsoft Entra, including checks for claims, scopes, roles and tenant validation. |\r\n| `src/functions/middleware/authMiddleware.ts`    | Middleware function that handles authorization using JWT tokens, integrating with the token validator.                       |\r\n| `src/functions/middleware/utils.ts`             | Utility functions for authentication, including retrieving JWKS URIs for different cloud environments.                       |\r\n| `src/functions/middleware/config.ts`            | Configuration file that exports Microsoft Entra app settings from environment variables.                                     |\r\n| `src/repairsData.json`                          | The data source for the repair API.                                                                                          |\r\n| `appPackage/apiSpecificationFile/repair.yml`    | A file that describes the structure and behavior of the repair API.                                                          |\r\n| `appPackage/manifest.json`                      | application manifest that defines metadata for your plugin inside Microsoft Teams.                                     |\r\n| `appPackage/ai-plugin.json`                     | The manifest file for your API plugin that contains information for your API and used by LLM.                                |\r\n| `appPackage/repairDeclarativeAgent.json`        | Define the behaviour and configurations of the declarative agent.                                                            |\r\n| `appPackage/adaptiveCards/listRepairs.json`     | Adaptive Card file used to render a result from the plugin response.                                                         |\r\n| `appPackage/adaptiveCards/listRepairs.data.json`| Sample mock data file for adaptive Card.                                                                                     |\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                 | Contents                                                                                                                                                                                                                                                |\r\n| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\r\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions.                                                                                                               |\r\n| `m365agents.local.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging.                                                                                                                                                                   |\r\n| `aad.manifest.json`  | This file defines the configuration of Microsoft Entra app. This template will only provision [single tenant](https://learn.microsoft.com/azure/active-directory/develop/single-and-multi-tenant-apps#who-can-sign-in-to-your-app) Microsoft Entra app. |\r\n{{^MicrosoftEntra}}\r\n\r\n## Extend the template\r\n\r\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\r\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\r\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\r\n- [Add Microsoft Copilot connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\r\n- [Add API plugins](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=7) for agent to interact with REST APIs.\r\n\r\n## How OAuth works in the API plugin\r\n\r\n![oauth-flow](https://github.com/OfficeDev/teams-toolkit/assets/107838226/f074abbe-d9e3-4a46-8e08-feb66b17a539)\r\n{{/MicrosoftEntra}}\r\n\r\n## Addition information and references\r\n\r\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\r\n- [Extend Microsoft 365 Copilot](https://aka.ms/teamsfx-copilot-plugin)\r\n- [Message extensions for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-message-extension-bot)\r\n- [Microsoft Copilot connectors for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-graph-connector)\r\n- [Microsoft 365 Copilot extensibility samples](https://learn.microsoft.com/microsoft-365-copilot/extensibility/samples)\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-scratch-oauth-ts",
      "declarative-agent-with-action-from-scratch-oauth-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "api-spec",
        "optionLabel": "Start with an OpenAPI Description Document"
      }
    ],
    "templateName": "api-plugin-from-existing-api",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create an action from your existing API",
    "readme": "# Overview of the basic declarative agent with API plugin template\r\n\r\n## Build a basic declarative agent with API plugin\r\n\r\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\r\n\r\nYou can extend declarative agents using plugins to retrieve data and execute tasks on external systems. A declarative agent can utilize multiple plugins at the same time.\r\n\r\n![image](https://github.com/user-attachments/assets/9939972e-0449-410c-b237-d9d748cd6628)\r\n\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run this app template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\r\n3. Select `Preview Local in Copilot (Edge)` or `Preview Local in Copilot (Chrome)` from the launch configuration dropdown.\r\n4. Select your declarative agent from the `Copilot` app.\r\n5. Send a prompt.\r\n\r\n{{#ApiKey}}\r\n> [!NOTE]\r\n> Microsoft 365 Agents Toolkit will ask you for your API key during provision. The API key will be securely stored with [Developer Portal](https://dev.teams.microsoft.com/home) and used by Teams client to access your API in runtime. Microsoft 365 Agents Toolkit will not store your API key.\r\n{{/ApiKey}}\r\n\r\n{{#OAuth}}\r\n> [!NOTE]\r\n> If your identity server needs Proof of Key Code Exchange (PKCE) for token exchange, uncomment the `isPKCEEnabled` property in the` oauth/register` section of the `m365agents.yml` file shown as below:\r\n```yaml\r\n  - uses: oauth/register\r\n    with:\r\n      name: {{ApiSpecAuthName}}\r\n      flow: authorizationCode\r\n      # app ID\r\n      appId: ${{TEAMS_APP_ID}}\r\n      # Path to OpenAPI description document\r\n      apiSpecPath: {{{ApiSpecPath}}}\r\n      # Uncomment below property to use proof key for code exchange (PKCE)\r\n      isPKCEEnabled: true\r\n    writeToEnvironmentFile:\r\n      configurationId: {{ApiSpecAuthRegistrationIdEnvName}}\r\n```\r\n> Microsoft 365 Agents Toolkit will ask you for your Client ID and Client Secret for Oauth2 during provision. These information will be securely stored with [Developer Portal](https://dev.teams.microsoft.com/home) and used by Teams client to access your API in runtime. Microsoft 365 Agents Toolkit will not store your Client ID and Client Secret.\r\n{{/OAuth}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                     |\r\n| ------------ | -------------------------------------------- |\r\n| `.vscode`    | VSCode files for debugging                   |\r\n| `appPackage` | Templates for the application manifest, the plugin manifest and the API specification |\r\n| `env`        | Environment files                            |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                                                       |\r\n| ------------------------------------ | ------------------------------------------------------------------------------ |\r\n| `appPackage/declarativeCopilot.json` | Define the behaviour and configurations of the declarative agent.            |\r\n| `appPackage/manifest.json`           | application manifest that defines metadata for your declarative agent. |\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                 | Contents                                                                                                                                  |\r\n| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\r\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\r\n\r\n## Addition information and references\r\n\r\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\r\n- [Extend Microsoft 365 Copilot](https://aka.ms/teamsfx-copilot-plugin)\r\n- [Message extensions for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-message-extension-bot)\r\n- [Microsoft Copilot connectors for Microsoft 365 Copilot](https://learn.microsoft.com/microsoft-365-copilot/extensibility/overview-graph-connector)\r\n- [Microsoft 365 Copilot extensibility samples](https://learn.microsoft.com/microsoft-365-copilot/extensibility/samples)",
    "supportedLanguages": [
      "none"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-existing-api"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "yes",
        "optionLabel": "Add an Action"
      },
      {
        "nodeId": "api-plugin-type",
        "optionId": "mcp",
        "optionLabel": "Start with an MCP server"
      }
    ],
    "templateName": "declarative-agent-with-action-from-mcp",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with an action - Create actions from your existing MCP server",
    "readme": "# Declarative Agent + MCP in VS Code \n\nThis template shows how to wrap your existing MCP Server into a Microsoft 365 Copilot Declarative Agent (DA) using the Agents Toolkit (ATK) in VS Code. Instead of hand‑authoring an OpenAPI spec, you point ATK at your MCP discovery URL and let the toolkit generate all manifests, wiring in authentication and function definitions automatically. \n\n## Get started with the template\n\n> **Prerequisites**\n>\n> To run this app template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\n\n1. Open ATK in VS Code\n\n    Click the Microsoft 365 Agents Toolkit icon in the Activity Bar. \n\n2. Sign in\n\n    Open the Agents Toolkit by click on the toolkit icon in the VS Code sidebar. Under Account, authenticate with your dev M365 account.\n\n3. Scaffold a new DA\n\n    In the Agents Toolkit menu, click 'Create new Agent/app', select 'Declarative Agent', choose a folder and name (e.g. my-mcp-agent).\n\n4. Add your MCP Server\n\n    In the ATK sidebar click Add Action → Start with an MCP server, then enter your MCP discovery URL (e.g. https://mcp.contoso.com/discover).\n\n5. Start your MCP Server \n\n    After the DA project generated, click the \"Start\" button in the mcp.json file to start your MCP server, when prompt, enter the user ID and password for authentication.\n\n6. Fetch and select tools \n\n    When prompted, Click ATK:Fetch Action from MCP\" in the mcp.json file choose Pre‑fetch tools (for offline IntelliSense) or Dynamic. ATK will list all available MCP actions—check the ones you want in your agent.\n\n7. Configure Auth\n\n    ATK will retrieve the authentication information for your MCP server and store these values are in env/.env.development and a secure reference is injected into appPackage/ai-plugin.json. If the inputted MCP server authentication information is not configure correctly according to the MCP protocol, ATK will prompt errors.\n\n8. Review generated files\n\n    - `appPackage/ai-plugin.json` (function definitions, runtime spec + auth) - This file defines the the action or operations that Copilot can interact with.\n    - `appPackage/declarativeAgent.json` (agent configuration & sample prompts) - This file is the definition of your declarative agent\n    - `appPackage/manifest.json` (Teams/Outlook integration)\n\n9. Provision & debug\n\n    Use the Provision button in ATK to create resources. ATK will detect if your MCP server requires OAuth2 or API‐Key. Provide your Client ID/Secret or Key when prompted. Then Start Debugging to Preview agent in Copilot in Edge/Chrome. Your DA will appear under Copilot chats.\n\n10. Test your MCP‑powered agent \n\n    Open the Copilot pane, select your agent and invoke any of the MCP tools with natural‑language prompts. \n\n## Project Structure\n\n| Folder       | Description                                                                                 |\n| ------------ | ---------------------------------------------------------------------------------------- |\n| `.vscode`    | ATK debug & .vscode/mcp.json for MCP server config                                                               |\n| `appPackage` | - `appPackage/ai-plugin.json` (function definitions, runtime spec + auth) - This file defines the the action or operations that Copilot can interact with<br>- `appPackage/declarativeAgent.json` (agent configuration & sample prompts) - This file is the definition of your declarative agent<br>- `appPackage/manifest.json` (Teams/Outlook integration)   |\n| `env`        | Local environment files (.env.development, .env.local)                                                                         |\n| `m365agents.yml` | Defines your DA stages & lifecycle for ATK  |\n\n## MCP‑specific tips\n\n- **Discovery URL**: your MCP server’s /discover endpoint must expose JSON‑Schema for every action.\n- **Tool selection**: the run_for_functions array in ai-plugin.json limits which MCP tools your agent can call.  \n\n- **Auth flows**: ATK supports both OAuth2.1 and API‑Key; you don’t need to hand‑edit auth blocks.  \n\n- **Versioning**: when your MCP server schema changes, simply rerun ATK: Fetch Action from MCP to refresh your plugin file.  \n\n- **Error logging**: basic request/response logs appear in the ATK console; errors bubble up in your Copilot chat. \n\n\n## Learn More\n\n- [Build Declarative Agents (official docs)](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents)\n\n- [Model Context Protocol (MCP)](https://modelcontextprotocol.io/)\n\n- [Agents Toolkit guide on GitHub](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview)\n\nHappy building! \n\nWith MCP + Declarative Agents, you’ll have a turnkey path from your existing APIs to a fully operational Copilot‑powered experience. \n",
    "supportedLanguages": [
      "common"
    ],
    "templateIds": [
      "declarative-agent-with-action-from-mcp"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "gc",
        "optionLabel": "Add a Copilot connector"
      }
    ],
    "templateName": "declarative-agent-with-graph-connector",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with a Copilot connector",
    "readme": "",
    "supportedLanguages": [
      "typescript"
    ],
    "templateIds": [
      "declarative-agent-with-graph-connector-ts"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "copilot-agent-type",
        "optionLabel": "Declarative Agent"
      },
      {
        "nodeId": "with-plugin",
        "optionId": "type-spec",
        "optionLabel": "Start with TypeSpec for Microsoft 365 Copilot"
      }
    ],
    "templateName": "declarative-agent-typespec",
    "description": "Create your own agent by declaring instructions, actions, & knowledge to suit your needs. - Create a declarative agent with or without an action using TypeSpec for Microsoft 365 Copilot",
    "readme": "# Overview of the Declarative Agent with TypeSpec for Microsoft 365 template\n\nWith the declarative agent, you can build a custom version of Copilot that can be used for specific scenarios, such as for specialized knowledge, implementing specific processes, or simply to save time by reusing a set of AI prompts. For example, a grocery shopping Copilot declarative agent can be used to create a grocery list based on a meal plan that you send to Copilot.\n\n## Get started with the template\n\n> **Prerequisites**\n>\n> To run this app template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\n> - [Microsoft 365 Copilot license](https://learn.microsoft.com/microsoft-365-copilot/extensibility/prerequisites#prerequisites)\n\n![image](./assets/image.png)\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\n3. Run `npm install` to install dependencies before working with TypeSpec files.\n4. Update the [`main.tsp`](./main.tsp) to configure your agent and its plugins. This is the default entry point for TypeSpec files. \n5. Select `Preview Local in Copilot (Edge)` or `Preview Local in Copilot (Chrome)` from the launch configuration dropdown.\n6. Select your declarative agent from the `Copilot` app.\n7. Ask a question to your declarative agent and it should respond based on the instructions provided.\n\n## What's included in the template\n\n| Folder       | Contents                                                                                 |\n| ------------ | ---------------------------------------------------------------------------------------- |\n| `.vscode`    | VSCode files for debugging                                                               |\n| `appPackage` | Templates for the application manifest, the GPT manifest and the API specification |\n| `env`        | Environment files                                                                        |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File                               | Contents                                                                     |\n| ---------------------------------- | ---------------------------------------------------------------------------- |\n| `appPackage/manifest.json`         | application manifest that defines metadata for your declarative agent. |\n\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\n\n| File           | Contents                                                                                                                                  |\n| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml` | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\n\nThe following are TypeSpec template files. You need to customize these files to configure your agent.\n\n| File          | Contents                                                                                    |\n| ------------- | ------------------------------------------------------------------------------------------- |\n| `main.tsp`    | This is the root file of TSP files. Please manually update this file to add your own agent. |\n| `actions.tsp` | This is the actions file containing API endpoints to extend your declarative agent.         |\n\n## Extend the template\n\n- [Add conversation starters](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=3): Conversation starters are hints that are displayed to the user to demonstrate how they can get started using the declarative agent.\n- [Add web content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=4) for the ability to search web information.\n- [Add OneDrive and SharePoint content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=5) as grounding knowledge for the agent.\n- [Add Microsoft Copilot Connectors content](https://learn.microsoft.com/microsoft-365-copilot/extensibility/build-declarative-agents?tabs=ttk&tutorial-step=6) to ground agent with enterprise knowledge.\n\n## Addition information and references\n\n- [Declarative agents for Microsoft 365](https://aka.ms/teams-toolkit-declarative-agent)\n",
    "supportedLanguages": [
      "common"
    ],
    "templateIds": [
      "declarative-agent-typespec"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "custom-engine-agent-type",
        "optionLabel": "Custom Engine Agent"
      },
      {
        "nodeId": "capabilities",
        "optionId": "basic-custom-engine-agent",
        "optionLabel": "Basic Custom Engine Agent"
      }
    ],
    "templateName": "basic-custom-engine-agent",
    "description": "Build intelligent agent where you manage orchestration and provide your own LLM - Intelligent agent that is built with Microsoft 365 Agents SDK and connects to your LLM",
    "readme": "# Overview of the Basic Custom Engine Agent template\r\n\r\nThis app template is built on top of [Microsoft 365 Agents SDK](https://github.com/Microsoft/Agents).\r\nIt showcases an agent that responds to user questions like ChatGPT. This enables your users to talk with the agent using your custome engine.\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22.\r\n{{^enableTestToolByDefault}}\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\r\n{{/enableTestToolByDefault}}\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) latest version or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli).\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/).\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource.\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#enableTestToolByDefault}}\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your agent in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an agent that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![Basic AI Agent](https://github.com/user-attachments/assets/984af126-222b-4c98-9578-0744790b103a)\r\n{{/enableTestToolByDefault}}\r\n{{^enableTestToolByDefault}}\r\n1. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't yet.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your agent in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\r\n1. When Teams launches in the browser, select the Add button in the dialog to install your agent to Teams.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an agent that can now interact with users in Teams:\r\n\r\n![Basic Custom Engine Agent](https://user-images.githubusercontent.com/7642967/258726187-8306610b-579e-4301-872b-1b5e85141eff.png)\r\n{{/enableTestToolByDefault}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Sets up the agent server.|\r\n|`src/adapter.ts`| Sets up the agent adapter.|\r\n|`src/config.ts`| Defines the environment variables.|\r\n|`src/agent.ts`| Handles business logics for the Basic Custom Engine Agent.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)\r\n\r\n## Known issue\r\n- The agent is currently not working in any Teams group chats or Teams channels when the stream response is enabled.\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "basic-custom-engine-agent-ts",
      "basic-custom-engine-agent-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "custom-engine-agent-type",
        "optionLabel": "Custom Engine Agent"
      },
      {
        "nodeId": "capabilities",
        "optionId": "weather-agent",
        "optionLabel": "Weather Agent"
      }
    ],
    "templateName": "weather-agent",
    "description": "Build intelligent agent where you manage orchestration and provide your own LLM - A weather forecast agent that is built with Microsoft 365 Agents SDK and LangChain",
    "readme": "# Overview of the Weather Agent template\r\n\r\nThis agent template is built on top of [Microsoft 365 Agents SDK](https://github.com/Microsoft/Agents).\r\nIt showcases a simple Weather Forecast Agent that is hosted on a express core web service. This Agent is configured to accept a request asking for information about a weather forecast and respond to the caller with an Adaptive Card.\r\n\r\nThis agent template is intended to introduce you the basics of integrating LangChain with the Microsoft 365 Agents SDK in order to build powerful Agents. It can also be used as a the base for a Custom Engine Agent that you choose to develop.\r\n\r\nNote: This template requires JSON output from the model which works best from newer versions of the model such as gpt-4o-mini.\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 18, 20, 22.\r\n{{^enableTestToolByDefault}}\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\r\n{{/enableTestToolByDefault}}\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) latest version or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli).\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/).\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource.\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#enableTestToolByDefault}}\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your agent in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an agent that can now interact with users in Microsoft 365 Agents Playground.\r\n\r\n{{/enableTestToolByDefault}}\r\n{{^enableTestToolByDefault}}\r\n1. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't yet.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your agent in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\r\n1. When Teams launches in the browser, select the Add button in the dialog to install your agent to Teams.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an agent that can now interact with users in Teams.\r\n\r\n{{/enableTestToolByDefault}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Sets up the agent server.|\r\n|`src/tools/*.ts`| Tools that can be utilized by model.|\r\n|`src/agent.ts`| Handles business logics for the Weather Agent.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)\r\n\r\n## Known issue\r\n- The agent is currently not working in any Teams group chats or Teams channels when the stream response is enabled.\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript"
    ],
    "templateIds": [
      "weather-agent-ts",
      "weather-agent-js"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "custom-copilot-basic",
        "optionLabel": "General Teams Agent"
      }
    ],
    "templateName": "custom-copilot-basic",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - Agent that chats with users in Teams built with Microsoft Teams SDK and connects to LLMs",
    "readme": "# Overview of the Basic AI Chatbot template\r\n\r\nThis app template is built on top of [Microsoft Teams SDK](https://aka.ms/teams-ai-library-v2).\r\nIt showcases an agent app that responds to user questions like ChatGPT. This enables your users to talk with the AI agent in Teams.\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22.\r\n{{^enableTestToolByDefault}}\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts).\r\n{{/enableTestToolByDefault}}\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) latest version or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli).\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/).\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource.\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#enableTestToolByDefault}}\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![Basic AI Chatbot](https://github.com/user-attachments/assets/984af126-222b-4c98-9578-0744790b103a)\r\n{{/enableTestToolByDefault}}\r\n{{^enableTestToolByDefault}}\r\n1. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't yet.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\r\n1. When Teams launches in the browser, select the Add button in the dialog to install your app to Teams.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Teams:\r\n\r\n![Basic AI Chatbot](https://user-images.githubusercontent.com/7642967/258726187-8306610b-579e-4301-872b-1b5e85141eff.png)\r\n{{/enableTestToolByDefault}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Application entry point. |\r\n|`src/config.ts`| Defines the environment variables.|\r\n|`src/app/instructions.txt`| Defines the prompt.|\r\n|`src/app/app.ts`| Handles business logics for the Basic AI Chatbot.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Extend the template\r\n\r\nTo extend the Basic AI Chatbot template with more AI capabilities, explore [Microsoft Teams SDK documentation](https://aka.ms/m365-agents-toolkit/teams-agent-extend-ai).\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)\r\n{{#CEAEnabled}}\r\n\r\n## Known issue\r\n- Streaming is only currently supported for single 1:1 chats, and not for groups or channels.\r\n{{/CEAEnabled}}",
    "supportedLanguages": [
      "typescript",
      "javascript",
      "python"
    ],
    "templateIds": [
      "custom-copilot-basic-ts",
      "custom-copilot-basic-js",
      "custom-copilot-basic-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "custom-copilot-rag",
        "optionLabel": "Teams Agent with Data"
      },
      {
        "nodeId": "custom-copilot-rag",
        "optionId": "custom-copilot-rag-customize",
        "optionLabel": "Customize"
      }
    ],
    "templateName": "custom-copilot-rag-customize",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - Agent that uses your content and knowledge to accurately answer domain-specific questions - Decide how to load your data",
    "readme": "# Overview of the Chat With Your Data (Custom Data Source) template\r\n\r\nThis app template showcases how to build one of the most powerful applications enabled by LLM - sophisticated question-answering (Q&A) chat bots that can answer questions about specific source information right in the Microsoft Teams.\r\nThis app template also demonstrates usage of techniques like: \r\n- [Retrieval Augmented Generation](https://python.langchain.com/docs/use_cases/question_answering/#what-is-rag), or RAG.\r\n- [Microsoft Teams SDK](https://aka.ms/teams-ai-library-v2)\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/).\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource.\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>` and deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![RAG Bot](https://github.com/user-attachments/assets/464fe1b0-d8c6-4ecf-a410-8dde7d9ca9b3)\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Application entry point.|\r\n|`src/config.ts`| Defines the environment variables.|\r\n|`src/app/app.ts`| Main application code.|\r\n|`src/app/myDataSource.ts`| Defines the data source.|\r\n|`src/data/*.md`| Raw text data sources.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Extend the template\r\n\r\nTo extend the Basic AI Chatbot template with more AI capabilities, explore [Microsoft Teams SDK documentation](https://aka.ms/m365-agents-toolkit/teams-agent-extend-ai).\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)",
    "supportedLanguages": [
      "typescript",
      "javascript",
      "python"
    ],
    "templateIds": [
      "custom-copilot-rag-customize-ts",
      "custom-copilot-rag-customize-js",
      "custom-copilot-rag-customize-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "custom-copilot-rag",
        "optionLabel": "Teams Agent with Data"
      },
      {
        "nodeId": "custom-copilot-rag",
        "optionId": "custom-copilot-rag-azureAISearch",
        "optionLabel": "Azure AI Search"
      }
    ],
    "templateName": "custom-copilot-rag-azure-ai-search",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - Agent that uses your content and knowledge to accurately answer domain-specific questions - Load your data from Azure AI Search service",
    "readme": "# Overview of the Chat With Your Data (Using Azure AI Search) template\r\n\r\nThis app template showcases how to build one of the most powerful applications enabled by LLM - sophisticated question-answering (Q&A) chat bots that can answer questions about specific source information right in the Microsoft Teams.\r\nThis app template also demonstrates usage of techniques like: \r\n- [Retrieval Augmented Generation](https://python.langchain.com/docs/use_cases/question_answering/#what-is-rag), or RAG.\r\n- [Azure AI Search](https://learn.microsoft.com/azure/search/search-what-is-azure-search)\r\n- [Microsoft Teams SDK](https://aka.ms/teams-ai-library-v2)\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/) and [Azure AI Search](https://azure.microsoft.com/en-us/products/ai-services/ai-search).\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource and [Azure AI Search](https://azure.microsoft.com/en-us/products/ai-services/ai-search).\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`. And fill in your Azure AI search key `SECRET_AZURE_SEARCH_KEY=<your-ai-search-key>` and endpoint `AZURE_SEARCH_ENDPOINT=<your-ai-search-endpoint>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_API_KEY=<your-key>`, endpoint `AZURE_OPENAI_ENDPOINT=<your-endpoint>`, deployment name `AZURE_OPENAI_DEPLOYMENT_NAME=<your-deployment>`, and embedding deployment name `AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME=<your-embedding-deployment>`. And fill in your Azure AI search key `SECRET_AZURE_SEARCH_KEY=<your-ai-search-key>` and endpoint `AZURE_SEARCH_ENDPOINT=<your-ai-search-endpoint>`.\r\n{{/useAzureOpenAI}}\r\n{{#useOpenAI}}\r\n1. Do `npm install` and `npm run indexer:create -- <your-ai-search-key> <your-openai-api-key>` to create the my documents index. Once you're done using the sample it's good practice to delete the index. You can do so with the `npm run indexer:delete -- <your-ai-search-key>` command.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. Do `npm install` and `npm run indexer:create -- <your-ai-search-key> <your-azure-openai-api-key>` to create the my documents index. Once you're done using the sample it's good practice to delete the index. You can do so with the `npm run indexer:delete -- <your-ai-search-key>` command.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![AI Search Bot](https://github.com/user-attachments/assets/464fe1b0-d8c6-4ecf-a410-8dde7d9ca9b3)\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Application entry point.|\r\n|`src/config.ts`| Defines the environment variables.|\r\n|`src/app/app.ts`| Main application code|\r\n|`src/app/azureAISearchDataSource.ts`| Defines the Azure AI search data source.|\r\n|`src/indexers/data/*.md`| Raw text data sources.|\r\n|`src/indexers/utils.ts`| Basic index tools. |\r\n|`src/indexers/setup.ts`| A script to create index and upload documents. |\r\n|`src/indexers/delete.ts`| A script to delete index and documents. |\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Extend the template\r\n\r\nTo extend the Basic AI Chatbot template with more AI capabilities, explore [Microsoft Teams SDK documentation](https://aka.ms/m365-agents-toolkit/teams-agent-extend-ai).\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)",
    "supportedLanguages": [
      "typescript",
      "javascript",
      "python"
    ],
    "templateIds": [
      "custom-copilot-rag-azure-ai-search-ts",
      "custom-copilot-rag-azure-ai-search-js",
      "custom-copilot-rag-azure-ai-search-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "custom-copilot-rag",
        "optionLabel": "Teams Agent with Data"
      },
      {
        "nodeId": "custom-copilot-rag",
        "optionId": "custom-copilot-rag-customApi",
        "optionLabel": "Custom API"
      }
    ],
    "templateName": "custom-copilot-rag-custom-api",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - Agent that uses your content and knowledge to accurately answer domain-specific questions - Load your data from custom APIs based on OpenAPI description document",
    "readme": "# Overview of the Chat With Your Data (Using Custom API) template\r\n\r\nThis template showcases how to build an AI-powered intelligent chatbot that can understand natural language to invoke the API defined in the OpenAPI description document, so you can enable your users to chat with the data provided through API service.\r\nThis app template is built on top of [Microsoft Teams SDK](https://aka.ms/teams-ai-library-v2), which provides the capabilities to build AI-based applications.\r\n\r\n## Get started with the template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22\r\n{{^enableTestToolByDefault}}\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\r\n{{/enableTestToolByDefault}}\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n{{#useOpenAI}}\r\n> - An account with [OpenAI](https://platform.openai.com/)\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n> - Prepare your own [Azure OpenAI](https://aka.ms/oai/access) resource.\r\n{{/useAzureOpenAI}}\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#enableTestToolByDefault}}\r\n{{#useOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.playground.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_ENDPOINT=<your-key>`, endpoint `SECRET_AZURE_OPENAI_ENDPOINT=<your-endpoint>` and deployment name `AZURE_OPENAI_MODEL_DEPLOYMENT_NAME=<your-deployment-name>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![custom api template](https://github.com/user-attachments/assets/8dcc7c2d-3438-4270-b91f-0693155fa8e0)\r\n{{/enableTestToolByDefault}}\r\n{{^enableTestToolByDefault}}\r\n1. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't yet.\r\n{{#useOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your OpenAI key `SECRET_OPENAI_API_KEY=<your-key>`.\r\n{{/useOpenAI}}\r\n{{#useAzureOpenAI}}\r\n1. In file *env/.env.local.user*, fill in your Azure OpenAI key `SECRET_AZURE_OPENAI_ENDPOINT=<your-key>`, endpoint `SECRET_AZURE_OPENAI_ENDPOINT=<your-endpoint> and deployment name `AZURE_OPENAI_MODEL_DEPLOYMENT_NAME=<your-deployment-name>`.\r\n{{/useAzureOpenAI}}\r\n1. Press F5 to start debugging which launches your app in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\r\n1. When Teams launches in the browser, select the Add button in the dialog to install your app to Teams.\r\n1. You can send any message to get a response from the agent.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Teams:\r\n\r\n![custom api template](https://github.com/OfficeDev/TeamsFx/assets/63089166/19f4c825-c296-4d29-a957-bedb88b6aa5b)\r\n{{/enableTestToolByDefault}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `appPackage/apiSpecificationFile` | Generated API spec file        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n| `src`        | The source code for the application                 |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`src/index.ts`| Application entry point.|\r\n|`src/config.ts`| Defines the environment variables.|\r\n|`src/app/instructions.txt`| Defines the prompt.|\r\n|`src/app/handlers.ts`| Function handlers.|\r\n|`src/app/functions.json`| Defines the functions.|\r\n|`src/app/utility.ts`| Utility methods for the AI agent.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Extend the template\r\n\r\nTo extend the Basic AI Chatbot template with more AI capabilities, explore [Microsoft Teams SDK documentation](https://aka.ms/m365-agents-toolkit/teams-agent-extend-ai).\r\n\r\n## Additional information and references\r\n\r\n- [Microsoft 365 Agents Toolkit Documentations](https://docs.microsoft.com/microsoftteams/platform/toolkit/teams-toolkit-fundamentals)\r\n- [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n- [Microsoft 365 Agents Toolkit Samples](https://github.com/OfficeDev/TeamsFx-Samples)\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript",
      "python"
    ],
    "templateIds": [
      "custom-copilot-rag-custom-api-ts",
      "custom-copilot-rag-custom-api-js",
      "teams-agent-with-data-custom-api-v2-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "teams-collaborator-agent",
        "optionLabel": "Teams Collaborator Agent"
      }
    ],
    "templateName": "teams-collaborator-agent",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - Agent that enhances collaboration in group chat, channels or meetings through summarization, task management, and conversation search",
    "readme": "# Collaborator Agent for Microsoft Teams\r\n\r\nThis intelligent collaboration assistant is built with the [Microsoft Teams SDK](https://aka.ms/teamsai-v2), and showcases how to create a sophisticated bot that can analyze conversations, manage tasks, and search through chat history using advanced AI capabilities and natural language processing.\r\n\r\nThis agent can listen to all messages in a group chat (even without being @mentioned) using RSC (Resource Specific Control) permissions defined in [App Manifest](appPackage/manifest.json). For more details, see the documentation [RSC Documentation](https://staticsint.teams.cdn.office.net/evergreen-assets/safelinks/2/atp-safelinks.html).\r\n\r\n## Key Features\r\n\r\n- 📋 **Intelligent Summarization** - Analyze conversations and provide structured summaries with proper participant attribution and topic identification\r\n- ✅ **Action Items** - Automatically identify and create action items from team discussions with smart assignment\r\n- 🔍 **Conversation Search** - Search through chat history using natural language queries with time-based filtering and deep linking to original messages\r\n\r\n## Adding Custom Capabilities\r\n\r\nAdding your own capabilities only requires a few steps:\r\n\r\n1. Copy the template folder under capabilities [template](src\\capabilities\\template\\template.ts)\r\n2. Customize your capability to do what you want (helpful to look at existing capabilities)\r\n3. Make sure to create a CapabilityDefinition at the bottom of your main file\r\n4. Register your capability by importing the CapabilityDefinition and adding to the definition list in [registry](src\\capabilities\\registry.ts)\r\n5. The manager will automatically be instantiated with the capability you defined!\r\n\r\n## Agent Architecture\r\n\r\n![architecture](./img/architecture.png)\r\n\r\n## Flow of the Agent\r\n\r\n![flow](./img/flow.png)\r\n\r\nIf Collab Agent is added to a groupchat or private message, it will always listen and log each message to its database. The messages are stored in an SQLite DB by the conversation ID of the given conversation. \r\nThe agent will respond whenever @mentioned in groupchats and will always respond in 1-on-1 messages. When the agent responds, the request is first passed through a manger prompt.\r\nThis manager may route to a capability based on the request--this capability returns its result back to the manager where it will be passed back to the user.\r\n\r\n## Running the Sample\r\n\r\n### Prerequisites\r\n\r\n- [Node.js](https://nodejs.org/) version 20, 22\r\n- [npm](https://www.npmjs.com/) (comes with Node.js)\r\n- [Microsoft 365 Agents Toolkit](https://marketplace.visualstudio.com/items?itemName=TeamsDevApp.ms-teams-vscode-extension) for Visual Studio Code\r\n- [Visual Studio Code](https://code.visualstudio.com/)\r\n- A Microsoft Teams account with the ability to upload custom apps\r\n- Azure OpenAI resource with GPT-4 deployment\r\n\r\n### Environment Variables\r\n\r\nUpdate the `.env.*.user` file with your configuration:\r\n  - `SECRET_AZURE_OPENAI_API_KEY`: Your Azure OpenAI API key\r\n  - `AZURE_OPENAI_ENDPOINT`: Your Azure OpenAI endpoint URL\r\n  - `AZURE_OPENAI_DEPLOYMENT_NAME`: Your GPT-4 model deployment name\r\n\r\n### Running the Bot\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n2. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n3. The browser will pop up to open Microsoft 365 Agents Playground.\r\n4. You will receive a welcome message from the agent, and you can send anything to the agent to get an response.\r\n5. @mention the bot in any conversation to start using its capabilities!\r\n\r\n#### Sample Questions\r\n\r\nYou can ask the Collaborator agent questions like:\r\n\r\n**Summarization:**\r\n- \"@Collaborator summarize yesterday's discussion\"\r\n- \"@Collaborator what were the main topics from last week?\"\r\n- \"@Collaborator give me an overview of recent messages\"\r\n\r\n**Action Items:**\r\n- \"@Collaborator find action items from the past 3 days\"\r\n- \"@Collaborator create a task to review the proposal by Friday\"\r\n- \"@Collaborator what tasks are assigned to me?\"\r\n\r\n**Search:**\r\n- \"@Collaborator find messages about the project deadline\"\r\n- \"@Collaborator search for conversations between Alice and Bob\"\r\n- \"@Collaborator locate discussions from this morning about the budget\"\r\n\r\n## Architecture\r\n\r\nThe Collaborator agent uses a sophisticated multi-capability architecture:\r\n\r\n- **Manager**: Coordinates between specialized capabilities and handles natural language time parsing\r\n- **Summarizer**: Analyzes conversation content and provides structured summaries\r\n- **Action Items**: Identifies tasks, manages assignments, and tracks completion\r\n- **Search**: Performs semantic search across conversation history with citation support\r\n- **Context Management**: Global message context handling for concurrent request support\r\n\r\n## Deployment\r\n\r\nThe agent can be deployed to Azure App Service for production use. See following documentation for detailed instructions on setting up Azure resources and configuring the production environment.\r\n- Host your app in Azure by [provision cloud resources](https://learn.microsoft.com/microsoftteams/platform/toolkit/provision) and [deploy the code to cloud](https://learn.microsoft.com/microsoftteams/platform/toolkit/deploy)\r\n- Azure SQL Database is used to store data, you can set admin password in `env/.env.dev.user`.\r\n\r\nIf you are trying to local debug / preview deployed version, then either of the two conditions must be met as a min-bar:\r\n1. The user doing the operation should be an admin in the org.\r\n2. The Entra app ID specified in webAppInfo.Id must be homed in the same tenant.\r\n",
    "supportedLanguages": [
      "typescript"
    ],
    "templateIds": [
      "teams-collaborator-agent-ts"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "others",
        "optionLabel": "Other Teams Capabilities"
      },
      {
        "nodeId": "teams-capability",
        "optionId": "tab-non-sso",
        "optionLabel": "Tab"
      }
    ],
    "templateName": "non-sso-tab",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - App that uses tab, bot and message extension - A simple implementation of a web app that's ready to customize",
    "readme": "# Overview of the Basic Tab template\n\nThis template showcases how Microsoft Teams supports the ability to run web-based UI inside \"custom tabs\" that users can install either for just themselves (personal tabs) or within a team or group chat context.\n\n## Get started with the Basic Tab template\n\n> **Prerequisites**\n>\n> To run the basic tab template in your local dev machine, you will need:\n>\n> - [Node.js](https://nodejs.org/), supported versions: >=20.\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\n>   Please note that after you enrolled your developer tenant in Office 365 Target Release, it may take couple days for the enrollment to take effect.\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 6.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\n3. Press F5 to start debugging which launches your app in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\n4. When Teams launches in the browser, select the Add button in the dialog to install your app to Teams.\n\n**Congratulations**! You are running an application that can now show a basic web page in Teams, Outlook and the Microsoft 365 app.\n\n![Basic Tab](https://github.com/user-attachments/assets/d87fa70b-238b-4f9f-bde8-cf16c086332d)\n\n## What's included in the template\n\n| Folder       | Contents                                     |\n| ------------ | -------------------------------------------- |\n| `.vscode`    | VSCode files for debugging                   |\n| `appPackage` | Templates for the application manifest |\n| `env`        | Environment files                            |\n| `infra`      | Templates for provisioning Azure resources   |\n| `src`        | The source code for the application    |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File                             | Contents                                                                                                        |\n| -------------------------------- | --------------------------------------------------------------------------------------------------------------- |\n| `index.html`                     | HTML file.                                                                                                      |\n| `src/Tab/App.css`                | CSS file for the app.                                                                                           |\n| `src/Tab/App.tsx`                | Tab source file. It calls `teamsjs` SDK to get the context of on which Microsoft 365 application your app is running.      |\n| `src/index.ts`                   | Starting the app using [Microsoft Teams SDK](https://microsoft.github.io/teams-ai).                                                                     |\n| `vite.config.js`                 | Configuration for Vite build tool.                                                                              |  \n| `nodemon.json`                   | Configuration for Nodemon to watch and restart the server.                                                      |\n\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\n\n| File                 | Contents                                                                                                                                  |\n| -------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml`       | This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions. |\n| `m365agents.local.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging.                                                     |\n\n## Extend the Basic Tab template\n\nFollowing documentation will help you to extend the Basic Tab template.\n\n- [Add or manage the environment](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-multi-env)\n- [Create multi-capability app](https://learn.microsoft.com/microsoftteams/platform/toolkit/add-capability)\n- [Access data in Microsoft Graph](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-sdk#microsoft-graph-scenarios)\n- [Use an existing Microsoft Entra application](https://learn.microsoft.com/microsoftteams/platform/toolkit/use-existing-aad-app)\n- [Customize the app manifest](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-preview-and-customize-app-manifest)\n- Host your app in Azure by [provision cloud resources](https://learn.microsoft.com/microsoftteams/platform/toolkit/provision) and [deploy the code to cloud](https://learn.microsoft.com/microsoftteams/platform/toolkit/deploy)\n- [Collaborate on app development](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-collaboration)\n- [Set up the CI/CD pipeline](https://learn.microsoft.com/microsoftteams/platform/toolkit/use-cicd-template)\n- [Publish the app to your organization or the Microsoft app store](https://learn.microsoft.com/microsoftteams/platform/toolkit/publish)\n- [Enable the app for multi-tenant](https://github.com/OfficeDev/TeamsFx/wiki/Multi-tenancy-Support-for-Azure-AD-app)\n- [Preview the app on mobile clients](https://aka.ms/teamsfx-mobile)\n",
    "supportedLanguages": [
      "typescript",
      "python"
    ],
    "templateIds": [
      "basic-tab-ts",
      "basic-tab-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "others",
        "optionLabel": "Other Teams Capabilities"
      },
      {
        "nodeId": "teams-capability",
        "optionId": "basic-message-extension",
        "optionLabel": "Message Extension"
      }
    ],
    "templateName": "default-message-extension",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - App that uses tab, bot and message extension - Receive user input, process it, and send customized results",
    "readme": "# Overview of Message Extensions template\n\nA Teams app that show cases three message extensions features:\n\n- action commands: allows users to interact with your app through buttons and forms in the compose message area in Microsoft Teams.\n- search commands: allows users to search for information or perform actions within the context of the message.\n- link unfurling: unfurls a link into an adaptive card when URLs with a particular domain are pasted into the compose message area in Microsoft Teams.\n\n## Get Started\n\n> **Prerequisites**\n>\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\n\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\n\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\n2. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser.\n3. The browser will pop up to open Microsoft 365 Agents Playground.\n4. Click the \"+\" button in the input box, select \"Action Command\" and input \"createCard\" into \"Command Id\" field. Select \"Static list of parameters\" and then click \"Create\". Fill out the form and click `Submit` to send an adaptive card to the current chat or channel.\n5. Click the \"+\" button in the input box, select \"Search Command\" and input \"searchQuery\" into \"Command Id\" field. Input a search query. Select one of the search results to send an adaptive card to the current chat or channel.\n6. Click the \"+\" button in the input box, select \"Link Unfurling\" and paste a link ending with `.botframework.com`. You should see an adaptive card unfurled. Click `Send to Conversation` to send it to the current chat or channel.\n\n## What's included in the template\n\n| Folder / File               | Contents                                                                                                                   |\n| --------------------------- | -------------------------------------------------------------------------------------------------------------------------- |\n| `m365agents.yml`            | Main project file describes your application configuration and defines the set of actions to run in each lifecycle stages  |\n| `m365agents.local.yml`      | This overrides `m365agents.yml` with actions that enable local execution and debugging                                     |\n| `m365agents.playground.yml` | This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground. |\n| `.vscode/`                  | VSCode files for local debug                                                                                               |\n| `src/`                      | The source code for the link unfurling application                                                                         |\n| `appPackage/`               | Templates for the application manifest                                                                                     |\n| `infra/`                    | Templates for provisioning Azure resources                                                                                 |\n\nThe following files can be customized and demonstrate an example implementation to get you started.\n\n| File           | Contents                              |\n| -------------- | ------------------------------------- |\n| `src/index.ts` | Application entry point               |\n| `src/card.ts`  | Adaptive card creation and management |\n",
    "supportedLanguages": [
      "typescript",
      "python"
    ],
    "templateIds": [
      "message-extension-v2-ts",
      "message-extension-v2-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "teams-agent-and-app-type",
        "optionLabel": "Teams Agents and Apps"
      },
      {
        "nodeId": "teams-app-type",
        "optionId": "others",
        "optionLabel": "Other Teams Capabilities"
      },
      {
        "nodeId": "teams-capability",
        "optionId": "bot",
        "optionLabel": "Simple Bot"
      }
    ],
    "templateName": "default-bot",
    "description": "Create agent, chat bot, web pages or other apps in Microsoft Teams using Microsoft Teams SDK. - App that uses tab, bot and message extension - A simple implementation of an echo bot that's ready for customization",
    "readme": "# Overview of the Basic Bot template\r\n\r\nExamples of Microsoft Teams bots in everyday use include:\r\n\r\n- Bots that notify about build failures.\r\n- Bots that provide information about the weather or bus schedules.\r\n- Bots that provide travel information.\r\n\r\nA bot interaction can be a quick question and answer, or it can be a complex conversation. Being a cloud application, a bot can provide valuable and secure access to cloud services and corporate resources. \r\nThis app template is built on top of [Microsoft Teams SDK](https://aka.ms/teams-ai-library-v2).\r\n## Get started with the Basic Bot template\r\n\r\n> **Prerequisites**\r\n>\r\n> To run the Basic Bot template in your local dev machine, you will need:\r\n>\r\n> - [Node.js](https://nodejs.org/), supported versions: 20, 22\r\n{{^enableTestToolByDefault}}\r\n> - A [Microsoft 365 account for development](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts)\r\n{{/enableTestToolByDefault}}\r\n> - [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher or [Microsoft 365 Agents Toolkit CLI](https://aka.ms/teamsfx-toolkit-cli)\r\n\r\n> For local debugging using Microsoft 365 Agents Toolkit CLI, you need to do some extra steps described in [Set up your Microsoft 365 Agents Toolkit CLI for local debugging](https://aka.ms/teamsfx-cli-debugging).\r\n\r\n1. First, select the Microsoft 365 Agents Toolkit icon on the left in the VS Code toolbar.\r\n{{#enableTestToolByDefault}}\r\n2. Press F5 to start debugging which launches your app in Microsoft 365 Agents Playground using a web browser. Select `Debug in Microsoft 365 Agents Playground`.\r\n3. The browser will pop up to open Microsoft 365 Agents Playground.\r\n4. You will receive a welcome message from the bot, and you can send anything to the bot to get an echoed response.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Microsoft 365 Agents Playground:\r\n\r\n![basic bot](./img/echo-bot.png)\r\n\r\n{{/enableTestToolByDefault}}\r\n{{^enableTestToolByDefault}}\r\n2. In the Account section, sign in with your [Microsoft 365 account](https://docs.microsoft.com/microsoftteams/platform/toolkit/accounts) if you haven't already.\r\n3. Press F5 to start debugging which launches your app in Teams using a web browser. Select `Debug in Teams (Edge)` or `Debug in Teams (Chrome)`.\r\n4. When Teams launches in the browser, select the Add button in the dialog to install your app to Teams.\r\n5. You will receive a welcome message from the bot, and you can send anything to the bot to get an echoed response.\r\n\r\n**Congratulations**! You are running an application that can now interact with users in Teams:\r\n\r\n![basic bot](https://github.com/OfficeDev/TeamsFx/assets/25220706/170096d2-b353-4d4e-b55a-2c8ae4d97514)\r\n{{/enableTestToolByDefault}}\r\n\r\n## What's included in the template\r\n\r\n| Folder       | Contents                                            |\r\n| - | - |\r\n| `.vscode`    | VSCode files for debugging                          |\r\n| `appPackage` | Templates for the application manifest        |\r\n| `env`        | Environment files                                   |\r\n| `infra`      | Templates for provisioning Azure resources          |\r\n\r\nThe following files can be customized and demonstrate an example implementation to get you started.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`app.ts`| Handles business logics for the echo bot.|\r\n|`index.ts`|`index.ts` is used to setup and configure the echo bot.|\r\n\r\nThe following are Microsoft 365 Agents Toolkit specific project files. You can [visit a complete guide on Github](https://github.com/OfficeDev/TeamsFx/wiki/Teams-Toolkit-Visual-Studio-Code-v5-Guide#overview) to understand how Microsoft 365 Agents Toolkit works.\r\n\r\n| File                                 | Contents                                           |\r\n| - | - |\r\n|`m365agents.yml`|This is the main Microsoft 365 Agents Toolkit project file. The project file defines two primary things:  Properties and configuration Stage definitions. |\r\n|`m365agents.local.yml`|This overrides `m365agents.yml` with actions that enable local execution and debugging.|\r\n|`m365agents.playground.yml`| This overrides `m365agents.yml` with actions that enable local execution and debugging in Microsoft 365 Agents Playground.|\r\n\r\n## Extend the Basic Bot template\r\n\r\nFollowing documentation will help you to extend the Basic Bot template.\r\n\r\n- [Add or manage the environment](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-multi-env)\r\n- [Create multi-capability app](https://learn.microsoft.com/microsoftteams/platform/toolkit/add-capability)\r\n- [Add single sign on to your app](https://learn.microsoft.com/microsoftteams/platform/toolkit/add-single-sign-on)\r\n- [Access data in Microsoft Graph](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-sdk#microsoft-graph-scenarios)\r\n- [Use an existing Microsoft Entra application](https://learn.microsoft.com/microsoftteams/platform/toolkit/use-existing-aad-app)\r\n- [Customize the app manifest](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-preview-and-customize-app-manifest)\r\n- Host your app in Azure by [provision cloud resources](https://learn.microsoft.com/microsoftteams/platform/toolkit/provision) and [deploy the code to cloud](https://learn.microsoft.com/microsoftteams/platform/toolkit/deploy)\r\n- [Collaborate on app development](https://learn.microsoft.com/microsoftteams/platform/toolkit/teamsfx-collaboration)\r\n- [Set up the CI/CD pipeline](https://learn.microsoft.com/microsoftteams/platform/toolkit/use-cicd-template)\r\n- [Publish the app to your organization or the Microsoft app store](https://learn.microsoft.com/microsoftteams/platform/toolkit/publish)\r\n- [Develop with Microsoft 365 Agents Toolkit CLI](https://aka.ms/teams-toolkit-cli/debug)\r\n- [Preview the app on mobile clients](https://aka.ms/teamsfx-mobile)\r\n",
    "supportedLanguages": [
      "typescript",
      "javascript",
      "python"
    ],
    "templateIds": [
      "default-bot-ts",
      "default-bot-js",
      "default-bot-python"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "office-meta-os-type",
        "optionLabel": "Office Add-in"
      },
      {
        "nodeId": "capabilities",
        "optionId": "wxp-json-taskpane",
        "optionLabel": "Task pane"
      }
    ],
    "templateName": "office-addin-wxpo-taskpane",
    "description": "Extend Office applications to interact with content in Office documents and Outlook items - Customize the ribbon with a button and embed content in the task pane",
    "readme": "# Build Office add-ins using Microsoft 365 Agents Toolkit\nOffice add-ins are integrations built by third parties into Office by using our web-based platform. This add-in template supports: Word, Excel, PowerPoint, Outlook.\nNow you have the ability to create a single unit of distribution for all your Microsoft 365 extensions by using the same manifest format and schema, based on the current JSON-formatted Teams manifest.\n\n> Note:\n> The unified app manifest for Word, Excel, and PowerPoint is in preview. Visit [this link](https://aka.ms/officeversions) to check the required Office Versions. Also, publishing a unified add-in for Word, Excel, PowerPoint is not supported currently.\n\n## Prerequisites\n\n- [Node.js](https://nodejs.org/), supported versions: 18, 20, 22.\n- Word/Excel/PowerPoint for Windows: Beta Channel, Build 18514 or higher. Outlook For Windows, Build 16425 or higher. Follow [this link](https://github.com/OfficeDev/TeamsFx/wiki/How-to-switch-Outlook-client-update-channel-and-verify-Outlook-client-build-version) for switching update channels and check your Office client build version.\n- Edge installed for debugging Office add-in.\n- A M365 account. If you do not have M365 account, apply one from [M365 developer program](https://developer.microsoft.com/en-us/microsoft-365/dev-program)\n- [Microsoft 365 Agents Toolkit Visual Studio Code Extension](https://aka.ms/teams-toolkit) version 5.0.0 and higher.\n\n## Debug Office add-in\n- Please note that the same M365 account should be used both in Microsoft 365 Agents Toolkit and Office.\n- From Visual Studio Code: Start debugging the project by choosing launch profile (default value is Word) in `Run and Debug` pane and hitting the `F5` key in Visual Studio Code. Please run VSCode as administrator if localhost loopback for Microsoft Edge Webview hasn't been enabled. Once enbaled, administrator priviledge is no longer required.\n\n## Edit the manifest\n\nYou can find the app manifest in `./appPackage` folder. The folder contains one manifest file:\n* `manifest.json`: Manifest file for Office add-in running locally or running remotely (After deployed to Azure).\nYou may add any extra properties or permissions you require to this file. See the [schema reference](https://raw.githubusercontent.com/OfficeDev/microsoft-teams-app-schema/preview/op/extensions/MicrosoftTeams.schema.json) for more information.\n\n## Deploy to Azure\n\nDeploy your project to Azure by following these steps:\n\n| From Visual Studio Code                                                                                                                                                                                                                                                                                                                                                  | From Microsoft 365 Agents Toolkit CLI                                                                                                                                                                                                                    |\n| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| <ul><li>Open Microsoft 365 Agents Toolkit, and sign into Azure by clicking the `Sign in to Azure` under the `ACCOUNTS` section from sidebar.</li> <li>After you signed in, select a subscription under your account.</li><li>Open the Microsoft 365 Agents Toolkit and click `Provision` from LIFECYCLE section or open the command palette and select: `Microsoft 365 Agents: Provision`.</li><li>Open the Microsoft 365 Agents Toolkit and click `Deploy` or open the command palette and select: `Microsoft 365 Agents: Deploy`.</li></ul> | <ul> <li>Run command `atk auth login azure`.</li> <li>(Optional)Set environment variable AZURE_SUBSCRIPTION_ID to your subscription id in env/.env.dev or in your current shell envrionment if you are using non-interactive mode of `teamsfx` CLI.</li> <li> Run command `atk provision`.</li> <li>Run command: `atk deploy`. </li></ul> |\n> Note: Provisioning and deployment may incur charges to your Azure Subscription.\n\nTo sideload the deployed add-in:\n\n- Copy the production URL from the `ADDIN_ENDPOINT` in env/.env.dev file.\n- Edit webpack.config.js file and change `urlProd` to the value you just copied. Please note to add a '/' at the end of the URL.\n- Run `npm run build`.\n- Run `npx office-addin-dev-settings sideload ./dist/manifest.json`.\n\n## Validate manifest file\n\nTo check that your manifest file is valid:\n\n- From Visual Studio Code: open the command palette and select: `Microsoft 365 Agents: Validate Application` and select `Validate using manifest schema`.\n- From Microsoft 365 Agents Toolkit CLI: run command `atk validate` in your project directory.\n\n## Known Issues\n- Publish is not supported for an Office add-in project now.",
    "supportedLanguages": [
      "typescript"
    ],
    "templateIds": [
      "office-addin-wxpo-taskpane-ts"
    ]
  },
  {
    "nodes": [
      {
        "nodeId": "project-type",
        "optionId": "office-meta-os-type",
        "optionLabel": "Office Add-in"
      },
      {
        "nodeId": "capabilities",
        "optionId": "office-addin-import",
        "optionLabel": "Upgrade an Existing Office Add-in"
      }
    ],
    "templateName": "office-addin-config",
    "description": "Extend Office applications to interact with content in Office documents and Outlook items - Upgrade an add-in project to the latest app manifest and project structure",
    "readme": "",
    "supportedLanguages": [
      "typescript"
    ],
    "templateIds": [
      "office-addin-config-ts"
    ]
  }
]